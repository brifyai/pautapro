# üöÄ SOLUCI√ìN R√ÅPIDA - ACTUALIZAR CONTRASE√ëA

## üìã PROBLEMA ACTUAL
‚úÖ Ya puedes entrar al sistema (modo emergencia activado)
‚ö†Ô∏è Necesitas actualizar la contrase√±a para eliminar el modo emergencia

## üîß PASO 1: ACTUALIZAR CONTRASE√ëA

### Ir a Supabase SQL Editor:
1. **Abre tu proyecto en Supabase**
2. **Ve a "SQL Editor"**
3. **Copia y pega este c√≥digo:**

```sql
-- Primero verificar estructura (ejecutar esto primero)
SELECT column_name, data_type FROM information_schema.columns WHERE table_name = 'usuarios' ORDER BY ordinal_position;

-- Si la columna es 'password', usar este UPDATE:
UPDATE usuarios
SET password = '$2b$12$mJodKxTVgvzbTl1HqpHi1.lP8juay3aJ8o7l3FBRHNV7wdV18.dBu'
WHERE email LIKE '%camilo%';

-- Verificar actualizaci√≥n
SELECT
    email,
    LEFT(password, 20) || '...' as password_actualizado,
    '‚úÖ Contrase√±a actualizada' as estado
FROM usuarios
WHERE email LIKE '%camilo%';
```

4. **Haz clic en "Run"**

## üîß PASO 2: CREAR TABLA MENSAJES (si a√∫n no existe)

### Mismo SQL Editor, pega esto:
```sql
-- Crear tabla mensajes
CREATE TABLE IF NOT EXISTS mensajes (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    remitente_id BIGINT REFERENCES usuarios(id) ON DELETE SET NULL,
    destinatario_id BIGINT REFERENCES usuarios(id) ON DELETE SET NULL,
    asunto TEXT NOT NULL,
    contenido TEXT NOT NULL,
    categoria VARCHAR(50) DEFAULT 'general',
    prioridad VARCHAR(20) DEFAULT 'media',
    leido BOOLEAN DEFAULT FALSE,
    fecha_envio TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    creado_en TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Insertar mensajes de ejemplo
INSERT INTO mensajes (remitente_id, destinatario_id, asunto, contenido, categoria, prioridad) VALUES
(
    (SELECT id FROM usuarios WHERE email LIKE '%camilo%' LIMIT 1),
    (SELECT id FROM usuarios WHERE email LIKE '%camilo%' LIMIT 1),
    'Bienvenido al Sistema',
    'Tu cuenta ha sido configurada correctamente.',
    'bienvenida',
    'baja'
),
(
    (SELECT id FROM usuarios WHERE email LIKE '%camilo%' LIMIT 1),
    (SELECT id FROM usuarios WHERE email LIKE '%camilo%' LIMIT 1),
    'Sistema Funcionando',
    'El modo emergencia ha sido desactivado.',
    'sistema',
    'media'
);

-- Verificar
SELECT COUNT(*) as total_mensajes FROM mensajes;
```

5. **Haz clic en "Run"**

## üéØ RESULTADO ESPERADO

### Despu√©s de ejecutar los scripts:
1. **Cierra y vuelve a abrir el navegador**
2. **Intenta hacer login nuevamente**
3. **Deber√≠as ver:**
   ```
   ‚úÖ Usando tabla: usuarios
   Contrase√±a hasheada detectada, usando bcrypt.compare
   Resultado bcrypt.compare: true
   ‚úÖ Contrase√±a verificada correctamente
   ```

### Sin modo emergencia:
- ‚ùå No deber√≠a aparecer "üö® MODO DE EMERGENCIA"
- ‚úÖ bcrypt.compare() deber√≠a retornar `true`
- ‚úÖ Login funcionando normalmente

## üîç VERIFICACI√ìN FINAL

### Para confirmar que todo est√° correcto:
1. **Login normal**: http://localhost:5173/login
2. **Credenciales**: `camiloalegriabarra@gmail.com` / `Antonito26`
3. **Sin errores**: No deber√≠a haber advertencias

## üéâ ¬°LISTO!

Una vez que ejecutes los scripts SQL:
- ‚úÖ El modo emergencia se desactivar√° autom√°ticamente
- ‚úÖ La contrase√±a funcionar√° con bcrypt correctamente
- ‚úÖ El sistema estar√° completamente operativo
- ‚úÖ La tabla mensajes funcionar√° sin errores 404

## üÜò SI HAY PROBLEMAS

### Si el login sigue fallando:
1. **Verifica que el script se ejecut√≥ correctamente**
2. **Revisa que aparezca "1 row affected" en Supabase**
3. **Limpia la cach√© del navegador (Ctrl+F5)**

### Si la tabla mensajes da error:
1. **Ejecuta el segundo script**
2. **Verifica que no haya errores en la consola de Supabase**

**üéØ ¬°Con estos 2 scripts el sistema estar√° 100% funcional!**